F := FiniteField(2);  
R<x,y>:=PolynomialRing(F,2);
A2<x,y> := AffineSpace(F,2);
pol:=x^21*y^18 - (x^22 + 17*x^21 + 49*x^20 + 42*x^19 + 36*x^18 + 30*x^17 + 25*x^16 + 20*x^15 + 16*x^14 + 12*x^13 + 9*x^12 + 6*x^11 + 4*x^10 + 2*x^9 + x^8)*y^17 
	- (x^32 + 4*x^31 + 12*x^30 + 28*x^29 + 58*x^28 + 108*x^27 + 188*x^26 + 308*x^25 + 483*x^24 + 727*x^23 + 1046*x^22 + 1310*x^21 + 1176*x^20 + 692*x^19 + 468*x^18 + 388*x^17 + 383*x^16 + 392*x^15 + 392*x^14 + 361*x^13 + 306*x^12 + 228*x^11 + 148*x^10 + 74*x^9 + 25*x^8)*y^16 
	+ (x^33 + 10*x^32 + 52*x^31 + 152*x^30 + 343*x^29 + 628*x^28 + 1000*x^27 + 1418*x^26 + 1886*x^25 + 2507*x^24 + 3685*x^23 + 6220*x^22 + 10748*x^21 + 15383*x^20 + 15542*x^19 + 10238*x^18 + 3790*x^17 - 1778*x^16 - 5596*x^15 - 7511*x^14 - 7688*x^13 - 6581*x^12 - 4734*x^11 - 2778*x^10 - 1201*x^9 - 300*x^8)*y^15 
	- (x^34 + 11*x^33 + 77*x^32 + 360*x^31 + 1171*x^30 + 2736*x^29 + 5013*x^28 + 7288*x^27 + 8146*x^26 + 5470*x^25 - 2618*x^24 - 15855*x^23 - 27512*x^22 - 20667*x^21 + 24002*x^20 + 102050*x^19 + 177288*x^18 + 220492*x^17 + 232733*x^16 + 221285*x^15 + 192881*x^14 + 153321*x^13 + 108925*x^12 + 66668*x^11 + 33071*x^10 + 11824*x^9 + 2300*x^8)*y^14 
	+ (x^35 + 12*x^34 + 88*x^33 + 472*x^32 + 2007*x^31 + 6707*x^30 + 17529*x^29 + 36321*x^28 + 61214*x^27 + 82814*x^26 + 80537*x^25 + 17807*x^24 - 158767*x^23 - 504959*x^22 - 1028592*x^21 - 1622733*x^20 - 2082672*x^19 - 2267670*x^18 - 2216740*x^17 - 2037962*x^16 - 1777274*x^15 - 1446358*x^14 - 1065734*x^13 - 681697*x^12 - 354509*x^11 - 130655*x^10 - 18721*x^9 + 12450*x^8 + 9440*x^7 + 3252*x^6 + 1005*x^5 + 270*x^4 + 60*x^3 + 10*x^2 + x)*y^13 
	- (x^36 + 13*x^35 + 100*x^34 + 560*x^33 + 2549*x^32 + 9890*x^31 + 33140*x^30 + 95102*x^29 + 233861*x^28 + 502048*x^27 + 967969*x^26 + 1714711*x^25 + 2823302*x^24 + 4307794*x^23 + 5999473*x^22 + 7475254*x^21 + 8235051*x^20 + 8136414*x^19 + 7592590*x^18 + 7097060*x^17 + 6648197*x^16 + 5891020*x^15 + 4626936*x^14 + 3001701*x^13 + 1403212*x^12 + 224760*x^11 - 353550*x^10 - 433760*x^9 - 281980*x^8 - 125656*x^7 - 43723*x^6 - 13755*x^5 - 3771*x^4 - 852*x^3 - 143*x^2 - 14*x)*y^12 
	+ (x^35 + 2*x^34 - 34*x^33 - 315*x^32 - 1266*x^31 - 2590*x^30 - 1527*x^29 + 1615*x^28 - 20027*x^27 - 144054*x^26 - 467748*x^25 - 987284*x^24 - 1447317*x^23 - 1391157*x^22 - 640040*x^21 + 63443*x^20 - 762552*x^19 - 3819288*x^18 - 7681486*x^17 - 9677478*x^16 - 8208148*x^15 - 3849227*x^14 + 1360603*x^13 + 5241809*x^12 + 6604636*x^11 + 5685924*x^10 + 3699045*x^9 + 1876157*x^8 + 768009*x^7 + 271550*x^6 + 87562*x^5 + 24607*x^4 + 5657*x^3 + 953*x^2 + 91*x)*y^11 
	- (x^35 + 6*x^34 - 26*x^33 - 435*x^32 - 2328*x^31 - 6317*x^30 - 4854*x^29 + 27896*x^28 + 113015*x^27 + 167368*x^26 - 120203*x^25 - 1225858*x^24 - 3293990*x^23 - 5275649*x^22 - 4585234*x^21 + 1351714*x^20 + 11785590*x^19 + 20862564*x^18 + 20865597*x^17 + 8449115*x^16 - 12471479*x^15 - 33532768*x^14 - 46851910*x^13 - 48635024*x^12 - 40392658*x^11 - 27397023*x^10 - 15276384*x^9 - 7091872*x^8 - 2839697*x^7 - 1032536*x^6 - 344786*x^5 - 99800*x^4 - 23330*x^3 - 3926*x^2 - 364*x)*y^10 
	+ (x^35 + 10*x^34 + 4*x^33 - 458*x^32 - 3617*x^31 - 14523*x^30 - 30773*x^29 - 974*x^28 + 232273*x^27 + 875445*x^26 + 1810689*x^25 + 1908302*x^24 - 1394979*x^23 - 11026383*x^22 - 26813292*x^21 - 41315628*x^20 - 40011546*x^19 - 9502129*x^18 + 51013137*x^17 + 125813937*x^16 + 190533689*x^15 + 224586762*x^14 + 219657921*x^13 + 181894373*x^12 + 127990221*x^11 + 76467435*x^10 + 38990819*x^9 + 17361296*x^8 + 7050167*x^7 + 2696250*x^6 + 945146*x^5 + 282710*x^4 + 66964*x^3 + 11180*x^2 + 1001*x)*y^9 
	- (x^35 + 14*x^34 + 56*x^33 - 250*x^32 - 4148*x^31 - 24816*x^30 - 89702*x^29 - 196951*x^28 - 134422*x^27 + 857560*x^26 + 4275026*x^25 + 11620978*x^24 + 21902798*x^23 + 27641045*x^22 + 12429256*x^21 - 44718274*x^20 - 156290215*x^19 - 312036242*x^18 - 476730241*x^17 - 604390282*x^16 - 658614329*x^15 - 626322697*x^14 - 521291396*x^13 - 378276856*x^12 - 238240892*x^11 - 130559326*x^10 - 63517805*x^9 - 28642052*x^8 - 12485623*x^7 - 5204748*x^6 - 1937704*x^5 - 597146*x^4 - 142076*x^3 - 23309*x^2 - 2002*x)*y^8 
	+ (x^35 + 18*x^34 + 130*x^33 + 322*x^32 - 2092*x^31 - 25950*x^30 - 146295*x^29 - 555058*x^28 - 1524836*x^27 - 2941504*x^26 - 2924471*x^25 + 4622834*x^24 + 32487179*x^23 + 99730733*x^22 + 224840276*x^21 + 412593017*x^20 + 642302207*x^19 + 868377263*x^18 + 1035865716*x^17 + 1101143787*x^16 + 1046533586*x^15 + 886256531*x^14 + 663767697*x^13 + 436978174*x^12 + 253871542*x^11 + 133692519*x^10 + 67506362*x^9 + 34439668*x^8 + 17445405*x^7 + 8079948*x^6 + 3155870*x^5 + 983226*x^4 + 231011*x^3 + 36751*x^2 + 3003*x)*y^7 
	- (x^35 + 22*x^34 + 225*x^33 + 1367*x^32 + 4922*x^31 + 5063*x^30 - 62112*x^29 - 507369*x^28 - 2384586*x^27 - 8449839*x^26 - 24460569*x^25 - 60027141*x^24 - 127419488*x^23 - 236788943*x^22 - 388521989*x^21 - 567191264*x^20 - 742535606*x^19 - 877954935*x^18 - 941120656*x^17 - 912599551*x^16 - 793658399*x^15 - 611882336*x^14 - 415491776*x^13 - 252008603*x^12 - 144757981*x^11 - 87094789*x^10 - 57335009*x^9 - 37826289*x^8 - 22210815*x^7 - 10814942*x^6 - 4220476*x^5 - 1285495*x^4 - 291626*x^3 - 44304*x^2 - 3408*x + 1)*y^6 
	+ (x^35 + 25*x^34 + 315*x^33 + 2645*x^32 + 16565*x^31 + 82215*x^30 + 335805*x^29 + 1158285*x^28 + 3437895*x^27 + 8902176*x^26 + 20305718*x^25 + 41067487*x^24 + 74018433*x^23 + 119563636*x^22 + 174412917*x^21 + 231787252*x^20 + 282326371*x^19 + 314413827*x^18 + 315546224*x^17 + 278499620*x^16 + 210619509*x^15 + 135865888*x^14 + 81959219*x^13 + 61226762*x^12 + 63578262*x^11 + 68329500*x^10 + 61954037*x^9 + 45095890*x^8 + 26232491*x^7 + 12205042*x^6 + 4519486*x^5 + 1306493*x^4 + 280782*x^3 + 40152*x^2 + 2859*x - 6)*y^5 
	- (120*x^28 + 2031*x^27 + 15918*x^26 + 75169*x^25 + 230360*x^24 + 441129*x^23 + 351413*x^22 - 710016*x^21 - 2873457*x^20 - 4182942*x^19 - 435519*x^18 + 11219569*x^17 + 26571124*x^16 + 33233637*x^15 + 18826267*x^14 - 17063049*x^13 - 59375966*x^12 - 87660466*x^11 - 90761581*x^10 - 72786998*x^9 - 46829429*x^8 - 24498267*x^7 - 10441072*x^6 - 3592826*x^5 - 972630*x^4 - 195696*x^3 - 25929*x^2 - 1641*x + 15)*y^4 
	+ (36*x^28 + 719*x^27 + 6759*x^26 + 39399*x^25 + 157184*x^24 + 442202*x^23 + 844157*x^22 + 836640*x^21 - 783129*x^20 - 5177481*x^19 - 11472490*x^18 - 14874257*x^17 - 7756364*x^16 + 15076584*x^15 + 50378218*x^14 + 85759225*x^13 + 106543988*x^12 + 105142473*x^11 + 85147731*x^10 + 57396458*x^9 + 32376554*x^8 + 15274061*x^7 + 5984930*x^6 + 1915194*x^5 + 483384*x^4 + 89855*x^3 + 10650*x^2 + 516*x - 20)*y^3 
	- (8*x^28 + 184*x^27 + 2024*x^26 + 14122*x^25 + 69803*x^24 + 257955*x^23 + 729657*x^22 + 1572959*x^21 + 2441977*x^20 + 2047639*x^19 - 1961191*x^18 - 12047905*x^17 - 28791571*x^16 - 49163902*x^15 - 66922237*x^14 - 75596479*x^13 - 72195871*x^12 - 58824524*x^11 - 41053393*x^10 - 24553067*x^9 - 12552914*x^8 - 5451061*x^7 - 1984296*x^6 - 590232*x^5 - 136653*x^4 - 22359*x^3 - 2022*x^2 + 6*x + 15)*y^2 
	+ (x^28 + 26*x^27 + 328*x^26 + 2672*x^25 + 15784*x^24 + 71984*x^23 + 263504*x^22 + 794752*x^21 + 2011868*x^20 + 4332536*x^19 + 8016592*x^18 + 12839552*x^17 + 17896136*x^16 + 21789445*x^15 + 23229260*x^14 + 21707891*x^13 + 17782603*x^12 + 12755615*x^11 + 7993768*x^10 + 4359323*x^9 + 2054062*x^8 + 825111*x^7 + 275340*x^6 + 72513*x^5 + 13440*x^4 + 1155*x^3 - 168*x^2 - 63*x - 6)*y
	- (x+1)^15;
X := Curve(A2,pol);
//assert Genus(X) eq 41;
load "gl2data.m";
N:=45;
assert GL2PointCount(GL2Borel1(N),2) eq GL2RationalCuspCount(GL2Borel1(N),2);
plc:=Places(X,1);
time Cl, CltoDiv, DivtoCl := ClassGroup(X); // takes a bit more than one minute
bpt := DivtoCl(Divisor(plc[1]));
G := sub<Cl | [DivtoCl(Divisor(plc[i])) - bpt : i in [2..#plc]]>;
G;
Valuation(#G, 2);
//fails



%%%%%%%%%%%%%%%%%%%%%%%%%%% sage %%%%%%%%%%%%%%%%%%%%%%%%

G=GammaH(45,[26])
cuspidal_rational_subgroup_mod_rational_cuspidal_subgroup(G)
rational_cuspidal_classgroup(G).invariants() 
//()
//(2, 12, 2281104)